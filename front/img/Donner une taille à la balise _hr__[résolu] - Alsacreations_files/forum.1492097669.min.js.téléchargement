function forum_notif_update(){var t=$forum_notif.data();t.action="notif-forum",$.get("/ajax.php",t,function(t){return t&&$forum_notif&&($forum_notif.html(t.html),t.n&&(document.title="("+t.n+") "+documentOriginalTitle)),clearInterval(ajaxIntervalNotifUpdate),ajaxIntervalNotifUpdateInterval+=5e3,!(ajaxIntervalNotifUpdateInterval>12e5)&&void(ajaxIntervalNotifUpdate=setInterval(forum_notif_update,ajaxIntervalNotifUpdateInterval))},"json")}!function(){var t={getSelection:function(){var t=this.jquery?this[0]:this;return("selectionStart"in t&&function(){var e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value.substr(t.selectionStart,e)}}||document.selection&&function(){t.focus();var e=document.selection.createRange();if(null==e)return{start:0,end:t.value.length,length:0};var a=t.createTextRange(),n=a.duplicate();return a.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",a),{start:n.text.length,end:n.text.length+e.text.length,length:e.text.length,text:e.text}}||function(){return{start:0,end:t.value.length,length:0}})()},replaceSelection:function(){var t=this.jquery?this[0]:this,e=arguments[0]||"";return("selectionStart"in t&&function(){return t.value=t.value.substr(0,t.selectionStart)+e+t.value.substr(t.selectionEnd,t.value.length),this}||document.selection&&function(){return t.focus(),document.selection.createRange().text=e,this}||function(){return t.value+=e,this})()}};jQuery.each(t,function(t){jQuery.fn[t]=this})}();var timeout_storage=!1,ajaxIntervalNotifUpdateInterval=6e4,ajaxIntervalNotifUpdate=!1,documentOriginalTitle=document.title,$forum_notif=!1;jQuery(document).ready(function(t){"use strict";t("#evitement a").on("focus",function(){t("#evitement").addClass("focused")}).on("keyup",function(e){27==e.keyCode&&t("#evitement").removeClass("focused")}),t("#evitement a:last").on("blur",function(){t("#evitement").removeClass("focused")}),t("#search-q").on({focus:function(){t("#search").addClass("focused")},blur:function(){t("#search").removeClass("focused")}}),t(".gofid").on("change",function(){window.location=t(this).find("option:selected").val()}),t("div.pages select.pg").on("change",function(){var e=t("div.pages input[name=pageurlbefore]").val(),a=t("div.pages input[name=pageurlafter]").val(),n=t(this).find("option:selected").val();window.location=e+n+a}),t("#dopoll").on("click",function(){t(this).is(":checked")?t("#divpoll").slideDown():t("#divpoll").slideUp()}),t("#doqcm").on("click",function(){t(this).is(":checked")?t("#maxrep").removeAttr("readonly"):t("#maxrep").attr("readonly","readonly")}),t("#pollq #choixqcm_b").on("click",function(){t(this).is(":checked")&&t("#pollq .choixqcm").removeAttr("checked")}),t("#pollq .choixqcm").on("click",function(){t("#pollq #choixqcm_b").removeAttr("checked");var e=t("#pollq .choixqcm:checked").length,a=t("#pollq #maxrep").val();e>a&&t(this).removeAttr("checked")});var e,a;if(t("#pmtextarea").on("keyup",function(){void 0===e&&(e=t("#pmmax").val(),a=t("#charsleft").css("color"));var n=e-t("#pmtextarea").val().length;t("#charsleft").val(n),n<1?t("#charsleft").css("color","red"):t("#charsleft").css("color",a)}),t("form").on("click",".other_smilies",function(){return t(this).remove(),0===t("#all_smilies").length&&t(".smilies").append('<div id="all_smilies"></div>'),t.get(t(this).attr("href")+"?"+1e4*Math.random(),function(e){t("#all_smilies").append(e)}),!1}),t(".smilies").on("click",".smiley",function(){return t("#message").replaceSelection(t(this).data("code"),!0),t("#message").trigger("focus"),!1}),t("#selectcolor").on("change",function(){var e=t("#message").getSelection().text;return 0!==t(this).find("option:selected").index()&&(t("#message").replaceSelection("[#"+t(this).find("option:selected").val()+"]"+e+"[/#]",!0),t("#message").trigger("focus"),!1)}),t(".codestyle").on("click",function(){var e=t("#message"),a=e.getSelection().text,n=t(this).attr("title").replace("...",a);e.replaceSelection(n,!0),e.trigger("focus")}),t("#avatar_actions").on("click",".avatar_gallery",function(){return t("#avatar_content").load("avatar.php?action=gallery"),!1}),t("#avatar_actions").on("click",".avatar_upload",function(){return t("#avatar_content").load("avatar.php"),!1}),t("#avatar_actions").on("click",".avatar_clear",function(){return t("[name=avatar]").val(""),t("#avatar_preview").hide(),t("#txtnoavatar").show(),t("#avatar_content").empty(),!1}),t("#avatar_content").on("click",".avatars_existing",function(){var e=t(this).data("name");return t("[name=avatar]").val(e),t("#imgavatar").attr("src","avatars/"+e),t("#avatar_preview").show(),t("#txtnoavatar").hide(),t("#avatar_content").empty(),!1}),t("#avatar_content").on("change",".avatar_userfile",function(e){t(".avatar_error").addClass("visuallyhidden");var a=new FileReader;if(a.onload=function(e){t("#imgavatar").off("load").on("load",function(){(t(this).height()>Math.round(t(this).data("maxheight"))||t(this).width()>Math.round(t(this).data("maxwidth")))&&t(".avatar_error").html("Erreur: Image trop grande, taille souhaitée : "+t(this).data("maxwidth")+"x"+t(this).data("maxheight")).removeClass("visuallyhidden")}),t("#imgavatar").attr("src",e.target.result)},e.target.files[0].type.match("image")){var n=Math.round(t(this).data("maxsize"));e.target.files[0].size>n?t(".avatar_error").html("Erreur: Image trop lourde : "+Math.round(e.target.files[0].size/1e3)+" Ko > "+Math.round(n/1e3)+" Ko").removeClass("visuallyhidden"):a.readAsDataURL(e.target.files[0])}else t(".avatar_error").html("Erreur: "+e.target.files[0].type+" type non approprié").removeClass("visuallyhidden"),t("#imgavatar").attr("src",""),t("#txtnoavatar").show()}),t("#doupload").on("click",function(){return t("#form-upload").load("upload.php"),!1}),t("#form-upload").on("click",":submit",function(e){var a=t("#img-upload").get(0).files[0],n=new FormData;n.append("userfile",a);var o=new XMLHttpRequest;return o.open("POST","upload.php"),o.onload=function(){200==this.status&&t("#form-upload").html(this.response)},o.send(n),!1}),t("#form-upload").on("click",".insert-bbcode",function(){t("#message").replaceSelection(t(this).data("code"),!0),t("#form-upload").empty()}),window.localStorage){var n=t(".js-storage-msg");n.on("keyup",function(e){clearTimeout(timeout_storage);var a=t(this);timeout_storage=setTimeout(function(){var t={text:a.val()},e=a.data("storagekey");e&&window.localStorage.setItem("forum-"+e,JSON.stringify(t))},1337)}),t(".js-storage-clear").each(function(){var e=t(this).data("storagekey");e&&window.localStorage.removeItem("forum-"+e)}),n.each(function(){var e=t(this).data("storagekey");if(e){var a=window.localStorage.getItem("forum-"+e);if(null!==a){var n=JSON.parse(a);"undefined"!=typeof n.text&&n.text.length>1&&t(this).val(n.text)}}})}t(".notbestlink, .bestlink").on("click",function(e){e.preventDefault();var a=t(this),n=a.attr("href"),o=a.data("pid"),i=t("#p"+o);a.hasClass("notbestlink")&&i.removeClass("isbest").find(".icon-ok").removeClass("icon-ok").addClass("icon-ok-outline"),a.hasClass("bestlink")&&(t(".isbest .icon-ok").removeClass("icon-ok").addClass("icon-ok-outline"),t(".isbest").removeClass("isbest"),i.addClass("isbest").find(".icon-ok-outline").removeClass("icon-ok-outline").addClass("icon-ok")),t.get(n,{ajax:!0},function(t){"ok"!==t&&i.removeClass("isbest").find(".icon-ok").removeClass("icon-ok").addClass("icon-ok-outline")},"text")}),t(".notlikelink, .likelink").on("click",function(e){e.preventDefault();var a=t(this),n=a.attr("href"),o=a.data("pid"),i=t("#p"+o);a.hasClass("notlikelink")&&i.removeClass("isliked").find(".icon-heart-filled").removeClass("icon-heart-filled").addClass("icon-heart"),a.hasClass("likelink")&&i.addClass("isliked").find(".icon-heart").removeClass("icon-heart").addClass("icon-heart-filled"),t.get(n,{ajax:!0},function(t){"ok"!==t&&i.removeClass("isliked")},"text")}),$forum_notif=t("#forum_notif"),$forum_notif.length>0&&clearInterval(ajaxIntervalNotifUpdate)});