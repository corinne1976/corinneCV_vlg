YUI.add("flickr-groups-search-fetcher",function(e,t){"use strict";function n(t){var n=e.merge(t)||{},r={extras:e.APIHelper.request.getRebootGroupExtras()+",use_vespa,membership_info,has_pending_invite,secure_rules",per_page:20,page:1,secure_image_embeds:1},i={filter_inactive_groups:"1",sort:e.SearchHelper.API_SORT_OPTIONS.relevant},s={perPage:"per_page",userId:e.SearchHelper.GROUPS_SEARCH_API.userId,subscriptionTypes:e.SearchHelper.GROUPS_SEARCH_API.subscriptionTypes,filterInactiveGroups:e.SearchHelper.GROUPS_SEARCH_API.filterInactive,safeSearch:e.SearchHelper.GROUPS_SEARCH_API.safeSearch};return Object.keys(n).forEach(function(e){s[e]&&(typeof n[e]!="undefined"&&(n[s[e]]=n[e]),delete n[e])}),n=e.merge(r,i,n),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(n),n.text?n:null}function r(t,n){var r=[],i,s,o,u,a,f=t[0],l=t[1],c=t[2];if(f.groups&&f.groups.group){o=f.groups.group.length;for(u=0;u<o;u++)a=f.groups.group[u],i=c.parseGroupModel(a.nsid,a.pathAlias,a),r.push(c.addOrUpdate(i));s={id:n.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},groups:{perPage:f.groups.perpage,page:f.groups.page||1,pageContent:r,totalItems:f.groups.total,totalPages:f.groups.pages},totalItems:f.groups.total,emptyQuery:!!n.emptyQuery,text:n.text,subscriptionTypes:n.subscriptionTypes,userId:n.userId,filterInactiveGroups:n.filterInactiveGroups,sort:n.sort},f.groups.maxAllowedResults&&(s.groups.totalItems=Math.min(f.groups.maxAllowedResults,f.groups.total)),f.groups.maxAllowedPages&&(s.groups.totalPages=Math.min(f.groups.maxAllowedPages,f.groups.pages));if(o)for(o;o<s.groups.perPage;o++)s.groups.pageContent.push(!1);return n.id&&n.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(s.apiParams=n.apiParams),l.addOrUpdate(s),r}}function i(r,i){var s="flickr.groups.search",o=n(r),u=[];return o||(r.emptyQuery=!0),r.emptyQuery?u.push(e.Promise.resolve({groups:{group:[]}})):u.push(i.callAPI(s,o)),u=u.concat([i.getModelRegistry("search-groups-models"),i.getModelRegistry("search-group-models")]),e.Promise.all(u).then(function(e){return this._processResponse(e,r)}.bind(this),e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-groups-search"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["api-helper","flickr-promise","search-helper","search-url","querystring-stringify-simple"]});
YUI.add("search-groups-models",function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-groups-search"].run(t,this.appContext)}},attributes:{id:{},text:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},subscriptionTypes:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},userId:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},groups:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-search"],listItemIdField:"id"}},filterInactiveGroups:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},sort:{setter:function(t){return e.AttributeHelpers.coerceString(t)}},page:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},pages:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},perPage:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["attribute-helpers","flickr-model-registry","flickr-groups-search-fetcher","search-helper"]});
