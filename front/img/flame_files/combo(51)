YUI.add("hermes-template-group-discussion-view",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.error:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(4,i,0),data:i}))!=null?s:""},2:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"		<div class='error-state'>\n			<p>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"groups.GROUP_DISCUSSION_LOADING_ERROR"},data:i}))+"<p>\n			<p><a href='#' class='retry'>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"groups.RETRY"},data:i}))+"</a></p>\n		</div>\n"},4:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.loading:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.program(7,i,0),data:i}))!=null?s:""},5:function(e,t,n,r,i){return"			<div class='loading'></div>\n"},7:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.discussions:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(46,i,0),data:i}))!=null?s:""},8:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"\n"+((s=n["if"].call(o,t!=null?t.titleKey:t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n.unless.call(o,t!=null?t.discussionLocked:t,{name:"unless",hash:{},fn:e.program(14,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n				<a class="search-icon" data-track="addContextGroupDiscussion" title="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.SEARCH_DISCUSSIONS"},data:i}))+'"></a>\n				<table class="with-avatar">\n					<tbody>\n						<tr class="header">\n							<th class="'+((s=n["if"].call(o,t!=null?t.shorterTitleLongerRecent:t,{name:"if",hash:{},fn:e.program(17,i,0),inverse:e.program(19,i,0),data:i}))!=null?s:"")+'">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_TITLE"},data:i}))+'</th>\n							<th class="col20">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_AUTHOR"},data:i}))+'</th>\n							<th class="col10 align-right">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_REPLIES"},data:i}))+'</th>\n							<th class="col20">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_LAST_REPLIER"},data:i}))+'</th>\n							<th class="'+((s=n["if"].call(o,t!=null?t.shorterTitleLongerRecent:t,{name:"if",hash:{},fn:e.program(21,i,0),inverse:e.program(23,i,0),data:i}))!=null?s:"")+' align-right">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_LAST_POST"},data:i}))+"</th>\n						</tr>\n"+((s=n.each.call(o,t!=null?t.discussions:t,{name:"each",hash:{},fn:e.program(25,i,0),inverse:e.noop,data:i}))!=null?s:"")+"					</tbody>\n				</table>\n\n"+((s=n["if"].call(o,t!=null?t.showMoreButton:t,{name:"if",hash:{},fn:e.program(43,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},9:function(e,t,n,r,i){var s;return"					<h2>\n"+((s=n["if"].call(t!=null?t:{},t!=null?t.showMoreButton:t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:"")+"					</h2>\n"},10:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'							<a href="/groups/'+a((s=(s=n.groupId||(t!=null?t.groupId:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"groupId",hash:{},data:i}):s))+'/discuss/" data-track="groupDiscussionHeadingClick">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:t!=null?t.titleKey:t},data:i}))+"</a>\n"},12:function(e,t,n,r,i){return"							"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:t!=null?t.titleKey:t},data:i}))+"\n"},14:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isMember:t,{name:"if",hash:{},fn:e.program(15,i,0),inverse:e.noop,data:i}))!=null?s:""},15:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'						<a href="'+a((s=(s=n.addTopicUrl||(t!=null?t.addTopicUrl:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"addTopicUrl",hash:{},data:i}):s))+'" class="add butt" data-track="groupDiscussionAddClick">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.GROUP_DISCUSSION_START"},data:i}))+"</a>\n"},17:function(e,t,n,r,i){return"col35"},19:function(e,t,n,r,i){return"col40"},21:function(e,t,n,r,i){return"col15"},23:function(e,t,n,r,i){return"col10"},25:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=e.lambda,f=e.escapeExpression,l=n.helperMissing,c="function";return"						<tr "+((s=n["if"].call(u,t!=null?t.isLocked:t,{name:"if",hash:{},fn:e.program(26,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n							<td class="'+((s=n["if"].call(u,t!=null?t.hasNewActivity:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n								'+((s=n["if"].call(u,t!=null?t.isSticky:t,{name:"if",hash:{},fn:e.program(30,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n\n								<a title="'+f(a(t!=null?t.subject:t,t))+'" href="'+f(a(t!=null?t.url:t,t))+'" data-track="groupDiscussionTopicSubjectClick">'+f(a(t!=null?t.subject:t,t))+'</a>\n							</td>\n							<td class="'+((s=n["if"].call(u,t!=null?t.hasNewActivity:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=n["if"].call(u,t!=null?t.authorIsDeleted:t,{name:"if",hash:{},fn:e.program(32,i,0),inverse:e.program(36,i,0),data:i}))!=null?s:"")+'							</td>\n							<td class="align-right '+((s=n["if"].call(u,t!=null?t.hasNewActivity:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n								<a href="'+f(a(t!=null?t.lastReplyUrl:t,t))+'" data-track="groupDiscussionTopicReplyCountClick">'+f(a(t!=null?t.countReplies:t,t))+'</a>\n							</td>\n							<td class="'+
((s=n["if"].call(u,t!=null?t.hasNewActivity:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=n["if"].call(u,t!=null?t.lastReplierIsDeleted:t,{name:"if",hash:{},fn:e.program(38,i,0),inverse:e.program(41,i,0),data:i}))!=null?s:"")+'							</td>\n							<td class="align-right '+((s=n["if"].call(u,t!=null?t.hasNewActivity:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n								<a href="'+f((o=(o=n.lastReplyUrl||(t!=null?t.lastReplyUrl:t))!=null?o:l,typeof o===c?o.call(u,{name:"lastReplyUrl",hash:{},data:i}):o))+'">\n									'+f((o=(o=n.dateSinceLastPost||(t!=null?t.dateSinceLastPost:t))!=null?o:l,typeof o===c?o.call(u,{name:"dateSinceLastPost",hash:{},data:i}):o))+"\n								</a>\n							</td>\n						</tr>\n"},26:function(e,t,n,r,i){return'class="is-locked"'},28:function(e,t,n,r,i){return"emphasis"},30:function(e,t,n,r,i){return'<span class="sticky">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_STICKY"},data:i}))+"</span>"},32:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'									<span data-person-nsid="'+u(o(t!=null?t.authorNSID:t,t))+'" class="avatar person tiny no-menu" style="background-image:url('+u(o(t!=null?t.authorBuddyicon:t,t))+');">\n									</span>'+u(o(t!=null?t.authorName:t,t))+((s=(n.isFlipped||t&&t.isFlipped||n.helperMissing).call(t!=null?t:{},"enable-pro-badge",{name:"isFlipped",hash:{},fn:e.program(33,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},33:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.authorIsPro:t,{name:"if",hash:{},fn:e.program(34,i,0),inverse:e.noop,data:i}))!=null?s:""},34:function(e,t,n,r,i){return'<a href="/account/upgrade/pro" class="pro-badge-inline">PRO</a>'},36:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'									<a title="'+u(o(t!=null?t.authorName:t,t))+'" href="'+u(o(t!=null?t.authorUrl:t,t))+'" data-track="groupDiscussionTopicAuthorClick">\n									<span data-person-nsid="'+u(o(t!=null?t.authorNSID:t,t))+'" class="avatar person tiny" style="background-image:url('+u(o(t!=null?t.authorBuddyicon:t,t))+');">\n									</span>'+u(o(t!=null?t.authorName:t,t))+((s=(n.isFlipped||t&&t.isFlipped||n.helperMissing).call(t!=null?t:{},"enable-pro-badge",{name:"isFlipped",hash:{},fn:e.program(33,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n									<span>\n									</a>\n"},38:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'									<span data-person-nsid="'+u(o(t!=null?t.lastReplierNSID:t,t))+'" class="avatar person tiny no-menu" style="background-image:url('+u(o(t!=null?t.lastReplierBuddyicon:t,t))+');"></span>'+u(o(t!=null?t.lastReplierName:t,t))+((s=(n.isFlipped||t&&t.isFlipped||n.helperMissing).call(t!=null?t:{},"enable-pro-badge",{name:"isFlipped",hash:{},fn:e.program(39,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},39:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.lastReplierIsPro:t,{name:"if",hash:{},fn:e.program(34,i,0),inverse:e.noop,data:i}))!=null?s:""},41:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'									<a title="'+u(o(t!=null?t.lastReplierName:t,t))+'" href="'+u(o(t!=null?t.lastReplierURL:t,t))+'" data-track="groupDiscussionTopicLastReplyUserClick">\n										<span data-person-nsid="'+u(o(t!=null?t.lastReplierNSID:t,t))+'" class="avatar person tiny" style="background-image:url('+u(o(t!=null?t.lastReplierBuddyicon:t,t))+');"></span>'+u(o(t!=null?t.lastReplierName:t,t))+((s=(n.isFlipped||t&&t.isFlipped||n.helperMissing).call(t!=null?t:{},"enable-pro-badge",{name:"isFlipped",hash:{},fn:e.program(39,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n									</a>\n"},43:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f=e.escapeExpression;return'				<div class="see-all-block">\n					<a href="/groups/'+f((o=(o=n.groupId||(t!=null?t.groupId:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"groupId",hash:{},data:i}):o))+'/discuss/" class="see-all-discussions '+((s=n["if"].call(u,t!=null?t.useButtonStyleSeeMore:t,{name:"if",hash:{},fn:e.program(44,i,0),inverse:e.noop,data:i}))!=null?s:"")+'" data-track="groupDiscussionViewAllClick">'+f((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"groups.SEE_ALL_DISCUSSIONS"},data:i}))+"</a>\n				</div>\n"},44:function(e,t,n,r,i){return"butt"},46:function(e,t,n,r,i){var s;return(s=n.unless.call(t!=null?t:{},t!=null?t.discussionLocked:t,{name:"unless",hash:{},fn:e.program(47,i,0),inverse:e.noop,data:i}))!=null?s:""},47:function(e,t,n,r,i){var s;return"					<div class='empty-state'>\n"+((s=n["if"].call(t!=null?t:{},t!=null?t.isMember:t,{name:"if",hash:{},fn:e.program(48,i,0),inverse:e.program(50,i,0),data:i}))!=null?s:"")+"					</div>\n"},48:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"							<p>"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.NO_DISCUSSIONS"},data:i}))+'</p>\n							<p><a href="'+a((s=(s=n.addTopicUrl||(t!=null?t.addTopicUrl:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"addTopicUrl",hash:{},data:i}):s))+'" data-track="groupDiscussionEmptyAddClick">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"groups.GROUP_DISCUSSION_START"},data:i}))+"</a></p>\n"},50:function(e,t,n,r,i){var s,o=t!=null?t:{};return"							<p>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"groups.JOIN_GROUP_TO_START_DISCUSSION"},data:i}))+'</p>\n\n							<div class="empty-state-actions">\n'+((s=n["if"].call(o,t!=null?t.signedIn:t,{name:"if",hash:{},fn:e.program(51,i,0),inverse:e.program(53,i,0),data:i}))!=null?s:"")+"							</div>\n\n"},51:function(e,t,n,r,i){return"									"+e.escapeExpression((n.outlet||t&&t.outlet||n.helperMissing).call(t!=null?t:{},t!=null?t["join-group-view"]:t,{name:"outlet",hash:{},
data:i}))+"\n"},53:function(e,t,n,r,i){return'									<a href="#" class="butt large">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:i}))+"</a>\n"},55:function(e,t,n,r,i){return"	<div class='hidden-state'>\n		<p>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"groups.DISCUSSION_MEMBERS_ONLY"},data:i}))+"</p>\n	</div>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showDiscussion:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(55,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/group-discussion-view",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("group-discussion-view",function(e){e.namespace("Views")[this.name]=e.Base.create("group-discussion-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.groupId=e.groupId,this.groupName=e.groupName,this.showDiscussion=e.showDiscussion,this.showLess=e.showLess!==!1,this.pageParams=e.pageParams||{page:1,fetchPageSize:20},this.titleKey=e.titleKey,this.useButtonStyleSeeMore=e.useButtonStyleSeeMore,this.get("container").get("innerHTML")===""&&this.setContainerWithTemplate("group-discussion-view",{loading:!0,error:!1}),this},subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,doRefreshOnStatusChange:!0,requiredToShowOnServer:!1}},loadState:function(){var t=this;return(new e.FlickrPromise({groupDiscussions:this.appContext.getModel("group-discussions-models",this.groupId),groupActivity:this.appContext.getModel("group-activity-models",this.groupId),group:this.appContext.getModel("group-models",this.groupId),groupInfo:this.appContext.getModel("group-info-models",this.groupId)})).then(function(e){return t.set("groupsDiscussionModel",e.groupDiscussions),t.set("groupActivityModel",e.groupActivity),t.set("groupInfoModel",e.groupInfo),t.showDiscussion=e.groupInfo.getValue("group").getValue("isMember")||e.groupInfo.getValue("group").getValue("showDiscussionToNonMembers"),e.groupDiscussions.getValue("discussions").getPage(t.pageParams).then(function(e){t.set("groupsDiscussions",e)})})},buildContainer:function(){var t=this.get("groupsDiscussions"),n=this.get("groupsDiscussionModel"),r,i=this,s=this.get("groupsActivityModel")?this.get("groupsActivityModel").getValue("latestViewedDate"):null,o,u=this.get("groupInfoModel"),a=u.getValue("group"),f=n.getValue("totalItems"),l=n.getValue("discussionLocked")||u.getValue("discussionsLocked"),c=t.map(function(t){return r=t.toJSON(),s&&(o=e.moment(r.dateLastPost).add(2,"w"),r.hasNewActivity=s.diff(o)<0),l&&(r.isLocked=!0),r.dateSinceLastPost=i.intlMessage(e.Handlebars.helpers._friendlySinceDate(r.dateSinceLastPost,!1,!0)),r}),h=!1,p=!1,d=this.appContext.lang.toLowerCase();return this.showLess?(f>this.pageParams.fetchPageSize&&(h=!0),c=c.slice(0,this.pageParams.fetchPageSize)):this.pageParams,["es-us","fr-fr","pt-br","vi-vn","id-id"].indexOf(d)>-1&&(p=!0),this.setContainerWithTemplate("group-discussion-view",{discussions:c,showDiscussion:this.showDiscussion,showMoreButton:h,groupId:this.groupId,addTopicUrl:"/groups_newtopic.gne?id="+this.groupId,titleKey:this.titleKey,groupname:this.groupname,loading:!1,error:!1,signedIn:this.appContext.getViewer().signedIn,discussionLocked:this.get("groupsDiscussionModel").getValue("discussionLocked"),isMember:a.getValue("isMember"),isHomePage:this.isHomePage,shorterTitleLongerRecent:p,useButtonStyleSeeMore:this.useButtonStyleSeeMore}),this},buildErrorContainer:function(){this.setContainerWithTemplate("group-discussion-view",{error:!0})},handleSearchClick:function(t){e.fire("add-context-to-search-field",{name:this.get("groupInfoModel").getValue("group").getValue("title"),id:this.groupId,type:"group",scope:"discussions"}),t.target.addClass("active")},handleSearchContextRemoval:function(){this.get("container").one(".search-icon").removeClass("active")},activate:function(){var t=this.get("container");return this.appContext.getViewer().signedIn&&this.get("groupActivityModel").registry.groupViewed({group_id:this.groupId,user_id:this.appContext.getViewer().nsid,type:"discussion"},this.appContext),this.appContext.getViewer().signedIn||this.registerEventHandler(t.delegate("click",function(t){e.SigninHelper._redirectToSignin()},".butt")),this.showDiscussion&&this.get("groupsDiscussionModel").getValue("totalItems")>0&&(this.registerEventHandler(this.get("container").one(".search-icon").on("click",this.handleSearchClick.bind(this))),this.registerEventHandler(e.on("remove-context-in-search-field",this.handleSearchContextRemoval.bind(this)))),this}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","moment","hermes-template-group-discussion-view","signin-helper"],langBundles:["groups","common","discussions","relative-dates"]});
YUI.add("hermes-lang-discussions_fr-fr",function(e,t){e.Intl.add("hermes/discussions","fr-FR",{REPLIES:[{type:"number",valueName:"count"}," r\u00e9ponses"],DELETED_USER:["supprim\u00e9"],RSS:["Fil\u00a0RSS"],DISCUSSIONS_WITH_TOTAL:["Discussions (",{type:"number",valueName:"count"},")"],ADDTOPIC:["Ajouter un sujet"],DISCUSSION_LOCK_TOPIC_PROMPT:["Cliquez pour verrouiller ce sujet"],DISCUSSION_UNLOCK_TOPIC_PROMPT:["Cliquez pour d\u00e9verrouiller ce sujet"],DISCUSSION_TOPIC_REPLY_PROMPT:["Cliquez pour r\u00e9pondre \u00e0 ce sujet"],DISCUSSION_TOPIC_PERMALINK:["Permalien"],DISCUSSION_TOPIC_DELETE_PROMPT:["Cliquez pour supprimer ce sujet"],DISCUSSION_TOPIC_EDIT_PROMPT:["Cliquez pour modifier ce sujet"],DISCUSSION_TOPIC_STICKY_PROMPT:["Cliquez pour marquer/supprimer le marquage de ce sujet comme \u00e9pingl\u00e9"],DISCUSSION_PUBLISH:["Publier"],DISCUSSION_PREVIEW:["Aper\u00e7u"]})},"@VERSION@",{requires:["intl"]});
