YUI.add("photo-list-subview",function(e,t){var n=require("hermes-core/type-validator"),r=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.PhotoListSubview=e.Base.create(this.name,e.FlickrView,[],{downloadCacheAndSetImage:function(){e.fluid.loadImage(this.get("photoUrl"),{timeout:1e3,retry:!0}).then(function(e){this.handleImageLoad(!0,e)}.bind(this),function(e){this.handleImageLoad(!1,e+"?retry="+Date.now())}.bind(this))},handleImageLoad:function(t,n){var r=this.get("photoContainer");r.setStyle("backgroundImage","url("+n+")"),t||r.setStyle("backgroundColor","#eee"),this.get("model").getValue("needsInterstitial")&&r.addClass("restricted-image"),e.fluid.chill(function(){this.fire(t?"loaded":"loadError")},this)},updateGeometry:function(e){e?this.set("layoutItem",e):e=this.get("layoutItem"),this.updateNodeGeometry(e,this.get("container"))},updateNodeGeometry:function(t,n){YUI.Env.isServer?n.setStyles({transform:"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-webkit-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-ms-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)"}):e.fluid.setStylePrefixed("transform","translate("+t.geometry.left+"px, "+t.geometry.top+"px)",n),t.forcedAspectRatio&&n.addClass("forced-aspect-ratio"),n.setStyles({width:t.geometry.width+"px",height:t.geometry.height+"px"})}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,t){return n.photoId(e)}},layoutItem:{validator:function(e,t){return typeof e=="object"&&e.hasOwnProperty("aspectRatio")&&e.hasOwnProperty("geometry")&&typeof e.geometry=="object"&&e.geometry.hasOwnProperty("width")&&e.geometry.hasOwnProperty("height")&&e.geometry.hasOwnProperty("top")&&e.geometry.hasOwnProperty("left")&&e.hasOwnProperty("isAwake")}},listModelParams:{writeOnce:"initOnly"},photoUrl:{value:"/images/spaceball.gif",getter:function(e,t){var n=this.get("model"),r=this.get("layoutItem"),i=n.getSizeToFit({width:r.geometry.width*this.get("photoContainerSize"),height:r.geometry.height*this.get("photoContainerSize")},{includeSquare:!1});return i.url}},linkedPageUrl:{writeOnce:!0,validator:function(t,n){return e.AttributeHelpers.validateString(t)}},model:{value:null},photoContainer:{readOnly:!0,derivedBy:["container"],getter:function(e){return YUI.Env.isServer?(r.warn("Cannot access photoContainer on the server; set values in the template instead. Falling back to view container."),this.get("container")):this.get("container").one(".photo")}},photoContainerSize:{value:1},measureAFT:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("hermes-template-photo-list-tag",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return" is-video"},3:function(e,t,n,r,i){return" restricted-image"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<a href="'+l((o=(o=n.linkedPageUrl||(t!=null?t.linkedPageUrl:t))!=null?o:a,typeof o===f?o.call(u,{name:"linkedPageUrl",hash:{},data:i}):o))+'"><div class="overlay"><div class="tag">'+l((o=(o=n.tag||(t!=null?t.tag:t))!=null?o:a,typeof o===f?o.call(u,{name:"tag",hash:{},data:i}):o))+'</div></div>\n<div class="photo'+((s=n["if"].call(u,(s=t!=null?t.photo:t)!=null?s.isVideo:s,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=n["if"].call(u,(s=t!=null?t.photo:t)!=null?s.needsInterstitial:s,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'" style="background-image: url(\''+l((o=(o=n.photoUrl||(t!=null?t.photoUrl:t))!=null?o:a,typeof o===f?o.call(u,{name:"photoUrl",hash:{},data:i}):o))+"');\"></div></a>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-list-tag",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-list-tag-view",function(e,t){var n=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.Base.create(this.name,e.PhotoListSubview,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e={};return e.linkedPageUrl="/photos/tags/"+this.get("model").id,e.photoUrl=this.get("photoUrl"),e.photo=this.get("model").toJSON(),e.tag=this.get("model").id,this.updateGeometry(),YUI.Env.isServer||this.downloadCacheAndSetImage(),this.setContainerWithTemplate("photo-list-tag",e),this},activate:function(){return this}},{ATTRS:{photoUrl:{value:"/images/spaceball.gif",getter:function(e,t){var r=this.get("model").getValue("photo"),i=this.get("layoutItem");r===null&&n.warn("Photo model empty for tag");var s=r.getSizeToFit({width:i.geometry.width,height:i.geometry.height},{includeSquare:!0});return s.url}}}})},"@VERSION@",{requires:["photo-list-subview","hermes-template-photo-list-tag","attribute-helpers"],optionalRequires:["fluid"],langBundles:["common"]});
